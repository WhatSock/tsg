/*
Modal Module R1.10
Copyright 2010-2018 Bryan Garaventa (WhatSock.com)
Refactoring Contributions Copyright 2018 Danny Allen (dannya.com) / Wonderscore Ltd (wonderscore.co.uk)
Part of AccDC, a Cross-Browser JavaScript accessibility API, distributed under the terms of the Open Source Initiative OSI - MIT License
*/
(function(){var a=[];$A.setModal=function(b){if(b&&!b.id){b.id=$A.genId()}if(typeof b.mode!=="number"){b.source=(function(){var c=$A.createEl("div");$A.load(c,b.source);return c})()}$A([b],{role:"Dialog",bind:"click",forceFocus:true,isStatic:"body",append:true,accStart:"Start",accEnd:"End",accClose:"Close",autoFix:9,allowCascade:true,runDuring:function(c){$A.query("body > *",function(){$A.setAttr(this,"aria-hidden","true")});$A.addClass(c.containerDiv,"containerDiv");c.firstField=$A.query('*[data-first="true"]',c.containerDiv)[0];c.lastField=$A.query('*[data-last="true"]',c.containerDiv)[0];$A.remAttr($A.setAttr(c.fn.closeLink,{tabindex:"0",role:"presentation"}),"href").innerHTML="";if(b.ariaDialog){$A.setAttr(c.accDCObj,{role:"dialog","aria-label":c.role,"aria-describedby":c.containerDivId,"aria-modal":"true"})}else{$A.setAttr(c.accDCObj,{role:"region","aria-label":c.role})}c.fn.sraStart.innerHTML=c.fn.sraEnd.innerHTML="";$A.setAttr(c.fn.sraStart,{"aria-hidden":"true"});$A.setAttr(c.fn.sraEnd,{"aria-hidden":"true"});if(b.alertDialog){c.announce=false}},runAfter:function(c){if(!a.length){$A.bind(window,"resize.accmodal",function(d){c.reposition()});$A.bind("body","focusin.accmodal",function(d){if(a[a.length-1].tempFocus){a[a.length-1].tempFocus=null}else{if(a[a.length-1].lastField){a[a.length-1].lastField.focus()}}})}a.push(c);if(b.alertDialog){$A.announce(c.containerDiv,false,true)}},runBeforeClose:function(c){a.pop();if(!a.length){$A.unbind(window,".accmodal");$A.unbind("body",".accmodal")}if(a.length){$A.setAttr(a[a.length-1].accDCObj,"aria-hidden","false");$A.remAttr(a[a.length-1].accDCObj,"aria-hidden")}else{$A.query("body > *",function(){$A.setAttr(this,"aria-hidden","false");$A.remAttr(this,"aria-hidden")})}$A.query("*",c.containerDiv,function(d,e){$A.unbind(e,"*")})},reposition:function(c){if(!a.length){return false}if(a[a.length-1].autoFix){a[a.length-1].applyFix()}else{if(a[a.length-1].autoPosition){a[a.length-1].setPosition()}}if(typeof c==="function"){c(a[a.length-1])}return true},focusIn:function(d,c){c.tempFocus=this},tabOut:function(d,c){if(c.firstField){c.firstField.focus()}},keyDown:function(e,c){var d=e.which||e.keyCode;if(d==27){c.close()}},closeClassName:"lbClose",className:"modal"},true);return b.id}})();